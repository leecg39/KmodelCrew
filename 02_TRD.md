# TRD (기술 요구사항 정의서)
## K모델크루 아카데미 홈페이지

**문서 버전:** v1.0  
**작성일:** 2026년 1월 7일  
**프로젝트 식별자:** KMODEL-2026  
**관련 문서:** PRD v1.0

---

## 1. 시스템 아키텍처 개요

### 1.1 전체 구조도

```
┌─────────────────────────────────────────────────────────────────┐
│                         사용자 (브라우저)                          │
│                    스마트폰 70% / PC 30%                          │
└─────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────┐
│                         Netlify (호스팅)                          │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  │
│  │   CDN (정적)     │  │  Functions      │  │   Forms         │  │
│  │   이미지, CSS    │  │  (서버리스)      │  │  (상담신청)      │  │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                                  │
                    ┌─────────────┼─────────────┐
                    ▼             ▼             ▼
┌───────────────────┐ ┌───────────────────┐ ┌───────────────────┐
│    Supabase       │ │   외부 서비스      │ │   Instagram       │
│  ┌─────────────┐  │ │  ┌─────────────┐  │ │   Graph API       │
│  │ PostgreSQL  │  │ │  │ 카카오맵    │  │ │   (피드 연동)      │
│  │ (데이터베이스)│  │ │  │ 알림톡     │  │ └───────────────────┘
│  └─────────────┘  │ │  └─────────────┘  │
│  ┌─────────────┐  │ └───────────────────┘
│  │  Storage    │  │
│  │ (이미지저장) │  │
│  └─────────────┘  │
└───────────────────┘
```

### 1.2 아키텍처 설계 원칙

| 원칙 | 설명 | 적용 |
|------|------|------|
| **단순성** | 1인 운영에 적합한 최소 복잡도 | 서버리스 아키텍처, 관리 포인트 최소화 |
| **확장성** | 향후 스토어 기능 추가 대비 | 모듈화된 컴포넌트 구조 |
| **성능** | 시니어 사용자의 느린 네트워크 대응 | 이미지 최적화, CDN 활용 |
| **비용 효율** | 무료~저비용 운영 | Netlify/Supabase 무료 플랜 활용 |

---

## 2. 기술 스택

### 2.1 프론트엔드

| 항목 | 선택 | 선택 이유 |
|------|------|-----------|
| **프레임워크** | Next.js 14 (App Router) | AI 코딩 도구 최적화, SSG/SSR 지원, 이미지 최적화 내장 |
| **언어** | TypeScript | 타입 안정성, 자동완성, 유지보수 용이 |
| **스타일링** | Tailwind CSS | 빠른 개발, 반응형 유틸리티, 일관된 디자인 시스템 |
| **상태 관리** | React Server Components + 최소 Client State | 서버 중심 렌더링, 복잡한 상태 관리 불필요 |

**대안 및 벤더 락인 리스크:**
| 대안 | 장단점 | 전환 비용 |
|------|--------|-----------|
| Gatsby | SSG 특화, 플러그인 풍부 | 중간 (React 기반 호환) |
| Astro | 더 가벼움, 부분 하이드레이션 | 중간 |
| Vue/Nuxt | Vue 생태계 | 높음 (프레임워크 변경) |

### 2.2 백엔드

| 항목 | 선택 | 선택 이유 |
|------|------|-----------|
| **BaaS** | Supabase | PostgreSQL 기반, 실시간 기능, 관리 UI 제공, 무료 플랜 충분 |
| **API** | Supabase Auto-generated REST API | 별도 백엔드 개발 불필요 |
| **서버리스 함수** | Netlify Functions | 알림톡 발송 등 외부 API 연동용 |

**대안 및 벤더 락인 리스크:**
| 대안 | 장단점 | 전환 비용 |
|------|--------|-----------|
| Firebase | Google 생태계, NoSQL | 중간 (DB 구조 변경 필요) |
| PlanetScale | MySQL 기반, 브랜칭 | 낮음 (SQL 호환) |
| 자체 서버 | 완전한 통제권 | 높음 (인프라 관리 필요) |

### 2.3 데이터베이스

| 항목 | 선택 | 선택 이유 |
|------|------|-----------|
| **DBMS** | PostgreSQL (Supabase) | 관계형 데이터에 적합, 안정성, SQL 표준 |
| **파일 저장소** | Supabase Storage | 모델 사진, 프로그램 이미지 저장 |
| **이미지 최적화** | Next.js Image + Supabase Transform | 자동 리사이징, WebP 변환 |

**대안 및 벤더 락인 리스크:**
| 대안 | 장단점 | 전환 비용 |
|------|--------|-----------|
| Cloudinary | 이미지 특화 CDN | 낮음 (URL 변경만) |
| AWS S3 | 확장성 최고 | 중간 (설정 복잡) |

### 2.4 배포 및 호스팅

| 항목 | 선택 | 선택 이유 |
|------|------|-----------|
| **호스팅** | Netlify | 무료 플랜 충분, CI/CD 내장, Forms 기능 |
| **도메인** | 사용자 보유 도메인 연결 | 브랜드 일관성 |
| **SSL** | Netlify 자동 발급 | 무료 HTTPS |

**예상 비용:**
| 구간 | 월 비용 | 조건 |
|------|---------|------|
| **초기 (MVP)** | 무료 | 방문자 5,000명 이하 |
| **성장기** | $0~19 | Netlify Pro 필요 시 |
| **확장기** | $19~50 | Supabase Pro 필요 시 |

**확장 전략:**
1. 무료 플랜으로 MVP 런칭 및 검증
2. 트래픽 증가 시 Netlify Pro 업그레이드
3. DB 용량 초과 시 Supabase Pro 업그레이드

### 2.5 외부 API/서비스

| 서비스 | 용도 | 대체 옵션 |
|--------|------|-----------|
| **카카오맵 API** | 찾아오는 길 지도 표시 | 네이버 지도, Google Maps |
| **Instagram Graph API** | 피드 자동 연동 | 수동 갤러리 업로드 |
| **카카오 알림톡 / NHN 문자** | 상담 신청 알림 | 이메일 알림, Slack 웹훅 |
| **Google Analytics 4** | 방문자 분석 | Plausible, Umami |

---

## 3. 비기능적 요구사항

### 3.1 성능

| 지표 | 목표 | 측정 방법 |
|------|------|-----------|
| **초기 로딩 시간 (LCP)** | 2.5초 이내 | Lighthouse, Web Vitals |
| **상호작용 지연 (INP)** | 200ms 이내 | Chrome DevTools |
| **레이아웃 이동 (CLS)** | 0.1 이하 | Lighthouse |
| **이미지 로딩** | Progressive/Lazy Loading | Next.js Image 컴포넌트 |

**최적화 전략:**
- 정적 생성(SSG)으로 대부분의 페이지 빌드 타임 렌더링
- 이미지 자동 최적화 (WebP, 적응형 크기)
- 코드 스플리팅으로 초기 번들 크기 최소화
- CDN을 통한 정적 자산 배포

### 3.2 보안

| 영역 | 요구사항 | 구현 방법 |
|------|----------|-----------|
| **전송 암호화** | 모든 통신 HTTPS | Netlify SSL 자동 적용 |
| **API 보안** | 환경 변수로 키 관리 | Netlify Environment Variables |
| **입력 검증** | 상담 신청 폼 유효성 검사 | 서버 사이드 검증 |
| **CORS** | 허용된 도메인만 API 접근 | Supabase RLS + CORS 설정 |
| **개인정보** | 최소 수집, 암호화 저장 | Supabase 암호화 |

### 3.3 확장성

| 시나리오 | 대응 방안 |
|----------|-----------|
| 트래픽 급증 (바이럴) | Netlify CDN 자동 스케일링 |
| DB 용량 증가 | Supabase Pro 업그레이드 |
| 기능 추가 (스토어) | 모듈화된 구조로 독립 개발 |

### 3.4 가용성

| 항목 | 목표 | 보장 방법 |
|------|------|-----------|
| **업타임** | 99.9% | Netlify/Supabase SLA |
| **장애 대응** | 자동 복구 | 서버리스 아키텍처 |
| **백업** | 일일 자동 백업 | Supabase 자동 백업 |

---

## 4. 데이터베이스 요구사항

### 4.1 스키마 설계 원칙

| 원칙 | 설명 |
|------|------|
| **정규화** | 3NF 수준 유지, 중복 최소화 |
| **확장성** | 향후 스토어 기능 추가 고려한 설계 |
| **단순성** | 1인 운영에 적합한 최소 테이블 |

### 4.2 주요 엔티티

| 엔티티 | 설명 | 예상 레코드 수 |
|--------|------|----------------|
| `models` | 소속 모델 정보 | 50~100 |
| `programs` | 아카데미 프로그램 | 5~10 |
| `instructors` | 강사진 정보 | 5~10 |
| `inquiries` | 상담 신청 내역 | 월 30+ |
| `site_content` | 회사 소개 등 정적 콘텐츠 | 10~20 |

### 4.3 인덱싱 전략

| 테이블 | 인덱스 컬럼 | 용도 |
|--------|-------------|------|
| `models` | `is_active`, `display_order` | 활성 모델 정렬 조회 |
| `programs` | `is_active`, `category` | 프로그램 필터링 |
| `inquiries` | `created_at`, `status` | 최신 문의 조회 |

---

## 5. 접근제어 및 권한 모델

### 5.1 역할 정의

| 역할 | 설명 | 권한 |
|------|------|------|
| **Public** | 일반 방문자 | 읽기 전용 (공개 콘텐츠) |
| **Admin** | 관리자 (원장님) | 모든 콘텐츠 CRUD, 문의 확인 |

### 5.2 권한 정책 (Supabase RLS)

```
# Public 정책
- models: SELECT (is_active = true)
- programs: SELECT (is_active = true)
- instructors: SELECT (is_active = true)
- site_content: SELECT (is_public = true)
- inquiries: INSERT only (상담 신청)

# Admin 정책
- 모든 테이블: SELECT, INSERT, UPDATE, DELETE
- 인증: Supabase Auth (이메일/비밀번호)
```

### 5.3 관리자 인증

| 항목 | 설계 |
|------|------|
| **인증 방식** | Supabase Auth (이메일/비밀번호) |
| **관리자 수** | 1명 (원장님) |
| **세션 관리** | JWT, 7일 만료 |
| **관리자 페이지** | `/admin` 경로, 인증 필수 |

---

## 6. 데이터 생명주기

### 6.1 개인정보 수집 원칙

| 원칙 | 적용 |
|------|------|
| **최소 수집** | 상담 신청에 필요한 정보만 수집 (이름, 연락처, 문의내용) |
| **목적 명시** | 상담 연락 목적으로만 사용 |
| **동의 획득** | 상담 신청 시 개인정보 수집 동의 체크박스 |

### 6.2 수집 데이터 목록

| 데이터 | 수집 경로 | 보관 기간 | 삭제 방법 |
|--------|-----------|-----------|-----------|
| 이름 | 상담 신청 폼 | 상담 완료 후 1년 | 자동 삭제 또는 수동 |
| 연락처 | 상담 신청 폼 | 상담 완료 후 1년 | 자동 삭제 또는 수동 |
| 문의 내용 | 상담 신청 폼 | 상담 완료 후 1년 | 자동 삭제 또는 수동 |
| 방문 로그 | Google Analytics | GA 정책 따름 | 익명화 처리 |

### 6.3 데이터 보존 및 삭제

```
수집 → 처리 → 보관 → 삭제/익명화
  │       │       │         │
  │       │       │         └─ 1년 후 자동 삭제 또는 익명화
  │       │       └─ Supabase 암호화 저장
  │       └─ 상담 연락 목적으로만 사용
  └─ 동의 후 수집
```

---

## 7. 폴더 구조 (권장)

```
kmodel-academy/
├── public/
│   ├── images/
│   │   └── logo.svg
│   └── fonts/
├── src/
│   ├── app/                    # Next.js App Router
│   │   ├── (public)/           # 공개 페이지 그룹
│   │   │   ├── page.tsx        # 홈
│   │   │   ├── about/          # 회사 소개
│   │   │   ├── programs/       # 프로그램 안내
│   │   │   ├── models/         # 소속 모델
│   │   │   └── contact/        # 문의하기
│   │   ├── admin/              # 관리자 페이지
│   │   │   ├── layout.tsx      # 관리자 레이아웃
│   │   │   ├── models/         # 모델 관리
│   │   │   ├── programs/       # 프로그램 관리
│   │   │   └── inquiries/      # 문의 관리
│   │   ├── layout.tsx          # 루트 레이아웃
│   │   └── globals.css
│   ├── components/
│   │   ├── ui/                 # 공통 UI 컴포넌트
│   │   ├── layout/             # 레이아웃 컴포넌트
│   │   └── features/           # 기능별 컴포넌트
│   ├── lib/
│   │   ├── supabase/           # Supabase 클라이언트
│   │   └── utils/              # 유틸리티 함수
│   └── types/                  # TypeScript 타입 정의
├── .env.local                  # 환경 변수 (로컬)
├── .env.production             # 환경 변수 (프로덕션)
├── tailwind.config.ts
├── next.config.ts
└── package.json
```

---

## 8. 환경 변수

| 변수명 | 용도 | 예시 |
|--------|------|------|
| `NEXT_PUBLIC_SUPABASE_URL` | Supabase 프로젝트 URL | `https://xxx.supabase.co` |
| `NEXT_PUBLIC_SUPABASE_ANON_KEY` | Supabase 공개 키 | `eyJ...` |
| `SUPABASE_SERVICE_ROLE_KEY` | Supabase 관리자 키 (서버 전용) | `eyJ...` |
| `KAKAO_MAP_API_KEY` | 카카오맵 API 키 | `abc123...` |
| `INSTAGRAM_ACCESS_TOKEN` | 인스타그램 API 토큰 | `IGQ...` |
| `ALIMTALK_API_KEY` | 알림톡 API 키 | `xxx...` |
| `ALIMTALK_SENDER_KEY` | 알림톡 발신 프로필 | `xxx...` |

---

## 9. 기술 스택 매트릭스 요약

| 레이어 | 기술 | 버전 | 비고 |
|--------|------|------|------|
| 프론트엔드 | Next.js | 14.x | App Router |
| 언어 | TypeScript | 5.x | Strict 모드 |
| 스타일링 | Tailwind CSS | 3.x | JIT 모드 |
| 데이터베이스 | PostgreSQL | 15.x | Supabase 제공 |
| BaaS | Supabase | Latest | Auth, Storage, DB |
| 호스팅 | Netlify | - | CDN, Functions |
| 지도 | 카카오맵 | v3 | JavaScript API |
| 분석 | Google Analytics | 4 | Web Vitals 포함 |

---

*이 문서는 PRD의 요구사항을 기술적으로 구현하기 위한 설계 명세입니다.*
